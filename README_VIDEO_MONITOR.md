# 视频监控功能实现说明

## 功能概述

本功能实现了设备创建成功后，在页面进行视频流画面展示，并支持分屏切换功能。

## 主要功能

### 1. 视频监控仪表板
- **位置**: `web/src/view/device/videoMonitor/index.vue`
- **功能**: 
  - 支持4分屏、9分屏、16分屏切换
  - 动态添加设备到视频槽位
  - 单个视频播放/暂停控制
  - 全部播放/停止控制
  - 设备状态显示
  - 视频加载状态提示

### 2. 设备创建后跳转
- **位置**: `web/src/view/device/monitorDevice/monitorDeviceForm.vue`
- **功能**: 设备创建成功后，弹出确认框询问是否跳转到视频监控页面

### 3. 设备列表页面增强
- **位置**: `web/src/view/device/monitorDevice/monitorDevice.vue`
- **功能**: 添加"视频监控"按钮，可直接跳转到监控页面

## 技术实现

### 前端技术栈
- Vue 3 + Composition API
- Element Plus UI组件库
- CSS Grid布局实现分屏效果
- HTML5 Video API处理视频流

### 后端支持
- 设备管理API (`/monitorDevice/*`)
- 视频流URL存储
- 设备状态管理

## 使用流程

### 1. 创建设备
1. 进入"设备管理" -> "监控设备"
2. 点击"新增"按钮
3. 填写设备信息（设备名称、分组ID、视频流地址等）
4. 点击"保存"

### 2. 跳转到视频监控
设备创建成功后，系统会弹出确认框：
- 选择"跳转到监控页面"：直接进入视频监控仪表板
- 选择"返回设备列表"：回到设备管理页面

### 3. 使用视频监控
1. 在视频监控页面，选择分屏模式（4/9/16分屏）
2. 点击空槽位的"+"按钮添加设备
3. 在弹出的设备选择器中选择要添加的设备
4. 点击播放按钮开始视频流
5. 使用"全部播放"/"全部停止"按钮批量控制

## 分屏模式说明

- **4分屏**: 2x2网格布局，适合查看少量设备
- **9分屏**: 3x3网格布局，默认模式，平衡显示效果和性能
- **16分屏**: 4x4网格布局，适合监控大量设备

## 视频流支持

支持多种视频流格式：
- RTSP流
- HTTP/HTTPS视频流
- WebRTC流（需要浏览器支持）
- HLS流
- MP4等常见视频格式

## 注意事项

1. **浏览器兼容性**: 不同浏览器对视频格式的支持可能不同
2. **网络要求**: 视频流需要稳定的网络连接
3. **性能考虑**: 同时播放多个视频流可能影响性能
4. **权限要求**: 确保设备有访问视频流的权限

## 故障排除

### 视频无法播放
1. 检查视频流URL是否正确
2. 确认网络连接正常
3. 检查浏览器是否支持该视频格式
4. 查看浏览器控制台错误信息

### 页面加载缓慢
1. 减少同时播放的视频数量
2. 检查网络带宽
3. 考虑使用较低分辨率的视频流

## 扩展功能

可以考虑添加的功能：
- 视频录制功能
- 截图功能
- 视频回放功能
- 移动侦测
- 视频质量调节
- 全屏显示
- 视频轮播

## 文件结构

```
web/src/view/device/
├── monitorDevice/
│   ├── monitorDevice.vue          # 设备列表页面
│   └── monitorDeviceForm.vue      # 设备创建/编辑页面
└── videoMonitor/
    └── index.vue                  # 视频监控仪表板

server/
├── api/v1/device/
│   └── monitor_device.go          # 设备管理API
├── model/device/
│   └── monitor_device.go          # 设备数据模型
└── source/system/
    └── menu.go                    # 菜单配置
``` 