/*! 
 Build based on gin-vue-admin 
 Time : 1753348791000 */
import{_ as e,aj as a,u as s,a as t,k as l,K as n,Q as u,ax as r,ao as o,g as i,c as v,o as m,f as c,a7 as d,w as p,F as y,D as g,i as f,b as h,n as b,h as S,t as x,v as I,al as q,ay as w,a8 as k,X as O,T as N}from"./087AC4D233B64EB0index.DdOzTnT7.js";const C={class:"gva-tabs"},E=["tab"],J=e(Object.assign({name:"HistoryComponent"},{__name:"index",setup(e){const J=a(),j=s(),A=e=>e.name+JSON.stringify(e.query)+JSON.stringify(e.params),P=t([]),V=t(""),_=t(!1),T=l(),L=t(0),R=t(0),B=t(!1),D=t(!1),K=t(""),Q=n(()=>T.userInfo.authority.defaultRouter),U=()=>{P.value=[{name:Q.value,meta:{title:"首页"},query:{},params:{}}],j.push({name:Q.value}),_.value=!1,sessionStorage.setItem("historys",JSON.stringify(P.value))},X=()=>{let e;const a=P.value.findIndex(a=>(A(a)===K.value&&(e=a),A(a)===K.value)),s=P.value.findIndex(e=>A(e)===V.value);P.value.splice(0,a),a>s&&j.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},F=()=>{let e;const a=P.value.findIndex(a=>(A(a)===K.value&&(e=a),A(a)===K.value)),s=P.value.findIndex(e=>A(e)===V.value);P.value.splice(a+1,P.value.length),a<s&&j.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},H=()=>{let e;P.value=P.value.filter(a=>(A(a)===K.value&&(e=a),A(a)===K.value)),j.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},M=e=>{if(!P.value.some(a=>((e,a)=>{if(e.name!==a.name)return!1;if(Object.keys(e.query).length!==Object.keys(a.query).length||Object.keys(e.params).length!==Object.keys(a.params).length)return!1;for(const s in e.query)if(e.query[s]!==a.query[s])return!1;for(const s in e.params)if(e.params[s]!==a.params[s])return!1;return!0})(a,e))){const a={};a.name=e.name,a.meta={...e.meta},delete a.meta.matched,a.query=e.query,a.params=e.params,P.value.push(a)}window.sessionStorage.setItem("activeValue",A(e))},Y=t({}),$=e=>{var a;const s=null==(a=null==e?void 0:e.props)?void 0:a.name;if(!s)return;const t=Y.value[s];j.push({name:t.name,query:t.query,params:t.params})},z=e=>{const a=P.value.findIndex(a=>A(a)===e);A(J)===e&&(1===P.value.length?j.push({name:Q.value}):a<P.value.length-1?j.push({name:P.value[a+1].name,query:P.value[a+1].query,params:P.value[a+1].params}):j.push({name:P.value[a-1].name,query:P.value[a-1].query,params:P.value[a-1].params})),P.value.splice(a,1)};u(()=>_.value,()=>{_.value?document.body.addEventListener("click",()=>{_.value=!1}):document.body.removeEventListener("click",()=>{_.value=!1})}),u(()=>J,e=>{"Login"!==e.name&&"Reload"!==e.name&&(P.value=P.value.filter(e=>!e.meta.closeTab),M(e),sessionStorage.setItem("historys",JSON.stringify(P.value)),V.value=window.sessionStorage.getItem("activeValue"))},{deep:!0}),u(()=>P.value,()=>{sessionStorage.setItem("historys",JSON.stringify(P.value)),Y.value={},P.value.forEach(e=>{Y.value[A(e)]=e}),o.emit("setKeepAlive",P.value)},{deep:!0});(()=>{o.on("closeThisPage",()=>{z(A(J))}),o.on("closeAllPage",()=>{U()}),o.on("mobile",e=>{D.value=e}),o.on("collapse",e=>{B.value=e}),o.on("setQuery",e=>{const a=P.value.findIndex(e=>A(e)===V.value);P.value[a].query=e,V.value=A(P.value[a]);const s=window.location.href.split("?")[0],t=new URLSearchParams(e).toString();window.history.replaceState({},"","".concat(s,"?").concat(t)),sessionStorage.setItem("historys",JSON.stringify(P.value))}),o.on("switchTab",async e=>{const a=P.value.findIndex(a=>a.name===e.name);if(!(a<0)){for(const a in e.query)e.query[a]=String(e.query[a]);for(const a in e.params)e.params[a]=String(e.params[a]);P.value[a].query=e.query||{},P.value[a].params=e.params||{},await N(),j.push(P.value[a])}});const e=[{name:Q.value,meta:{title:"首页"},query:{},params:{}}];M(J),P.value=JSON.parse(sessionStorage.getItem("historys"))||e,window.sessionStorage.getItem("activeValue")?V.value=window.sessionStorage.getItem("activeValue"):V.value=A(J),"true"===window.sessionStorage.getItem("needCloseAll")&&(U(),window.sessionStorage.removeItem("needCloseAll"))})(),r(()=>{o.off("collapse"),o.off("mobile")});return(e,a)=>{const s=i("el-tab-pane"),t=i("el-tabs");return m(),v("div",C,[c(t,{modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),closable:!(1===P.value.length&&e.$route.name===Q.value),type:"card",class:"bg-white text-slate-700 dark:text-slate-500 dark:bg-slate-900",onContextmenu:a[1]||(a[1]=w(e=>(e=>{if(1===P.value.length&&J.name===Q.value)return!1;let a="";a="SPAN"===e.srcElement.nodeName?e.srcElement.offsetParent.id:e.srcElement.id,a&&(_.value=!0,L.value=e.clientX,R.value=e.clientY+10,K.value=a.substring(4))})(e),["prevent"])),onTabClick:$,onTabRemove:z,onMouseup:a[2]||(a[2]=w(e=>(e=>{if(1===P.value.length&&J.name===Q.value)return!1;let a="";a="SPAN"===e.srcElement.nodeName?e.srcElement.offsetParent.id:e.srcElement.id,a&&z(a.substring(4))})(e),["middle","prevent"]))},{default:p(()=>[(m(!0),v(y,null,g(P.value,e=>(m(),f(s,{key:A(e),label:e.meta.title,name:A(e),tab:e,class:"border-none"},{label:p(()=>[h("span",{tab:e,class:b(V.value===A(e)?"text-active":"text-gray-600 dark:text-slate-400 ")},[h("i",{class:b(V.value===A(e)?"text-active":"text-gray-600 dark:text-slate-400")},null,2),S(" "+x(I(q)(e.meta.title,e)),1)],10,E)]),_:2},1032,["label","name","tab"]))),128))]),_:1},8,["modelValue","closable"]),d(h("ul",{style:O({left:L.value+"px",top:R.value+"px"}),class:"contextmenu"},[h("li",{onClick:U},"关闭所有"),h("li",{onClick:X},"关闭左侧"),h("li",{onClick:F},"关闭右侧"),h("li",{onClick:H},"关闭其他")],4),[[k,_.value]])])}}}),[["__scopeId","data-v-4e7543cd"]]);export{J as default};
