/*! 
 Build based on gin-vue-admin 
 Time : 1753275382000 */
import{_ as e,a,Q as t,g as l,c as o,o as s,b as n,f as u,w as r,h as d,d as c,t as i,ay as m,X as p,b4 as y,b5 as f,T as h,E as v,b6 as w}from"./087AC4D233B64EB0index.D_4CqggS.js";import{u as k}from"./087AC4D233B64EB0authority.BkabWgkw.js";import{g as _,s as I}from"./087AC4D233B64EB0authorityBtn.CBSaCnzw.js";const b={class:"sticky top-0.5 z-10"},g={class:"tree-content clear-both"},C={class:"custom-tree-node"},D={key:0},R={key:1},B={class:"dialog-footer"},x=e(Object.assign({name:"Menus"},{__name:"menus",props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(e,{expose:x,emit:E}){const A=e,V=E,j=a(""),N=a([]),O=a([]),T=a(!1),S=a({children:"children",label:function(e){return e.meta.title},disabled:function(e){return A.row.defaultRouter===e.name}});(async()=>{const e=await y();N.value=e.data.menus;const a=(await f({authorityId:A.row.authorityId})).data.menus,t=[];a.forEach(e=>{a.some(a=>a.parentId===e.menuId)||t.push(Number(e.menuId))}),O.value=t})();const U=()=>{T.value=!0},z=a(null),F=async()=>{const e=z.value.getCheckedNodes(!1,!0);0===(await w({menus:e,authorityId:A.row.authorityId})).code&&v({type:"success",message:"菜单设置成功!"})};x({enterAndNext:()=>{F()},needConfirm:T});const G=a(!1),M=a([]),Q=a([]),X=a();let q="";const H=e=>{Q.value=e},J=e=>{G.value=!0,M.value=e.menuBtn},K=()=>{G.value=!1},L=async()=>{const e=Q.value.map(e=>e.ID);0===(await I({menuID:q,selected:e,authorityId:A.row.authorityId})).code&&(v({type:"success",message:"设置成功"}),G.value=!1)},P=(e,a)=>!e||-1!==a.meta.title.indexOf(e);return t(j,e=>{z.value.filter(e)}),(a,t)=>{const y=l("el-input"),f=l("el-button"),v=l("el-tree"),w=l("el-scrollbar"),I=l("el-table-column"),x=l("el-table"),E=l("el-dialog");return s(),o("div",null,[n("div",b,[u(y,{modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=e=>j.value=e),class:"w-3/5",placeholder:"筛选"},null,8,["modelValue"]),u(f,{class:"float-right",type:"primary",onClick:F},{default:r(()=>t[2]||(t[2]=[d("确 定")])),_:1,__:[2]})]),n("div",g,[u(w,null,{default:r(()=>[u(v,{ref_key:"menuTree",ref:z,data:N.value,"default-checked-keys":O.value,props:S.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":P,onCheck:U},{default:r(({node:a,data:l})=>[n("span",C,[n("span",null,i(a.label),1),a.checked?(s(),o("span",D,[u(f,{type:"primary",link:"",style:p({color:e.row.defaultRouter===l.name?"#E6A23C":"#85ce61"}),onClick:m(()=>(async e=>{const a=await k({authorityId:A.row.authorityId,AuthorityName:A.row.authorityName,parentId:A.row.parentId,defaultRouter:e.name});0===a.code&&(F(),V("changeRow","defaultRouter",a.data.authority.defaultRouter))})(l),["stop"])},{default:r(()=>[d(i(e.row.defaultRouter===l.name?"首页":"设为首页"),1)]),_:2},1032,["style","onClick"])])):c("",!0),l.menuBtn.length?(s(),o("span",R,[u(f,{type:"primary",link:"",onClick:m(()=>(async e=>{q=e.ID;const a=await _({menuID:q,authorityId:A.row.authorityId});0===a.code&&(J(e),await h(),a.data.selected&&a.data.selected.forEach(e=>{M.value.some(a=>{a.ID===e&&X.value.toggleRowSelection(a,!0)})}))})(l),["stop"])},{default:r(()=>t[3]||(t[3]=[d(" 分配按钮 ")])),_:2,__:[3]},1032,["onClick"])])):c("",!0)])]),_:1},8,["data","default-checked-keys","props"])]),_:1})]),u(E,{modelValue:G.value,"onUpdate:modelValue":t[1]||(t[1]=e=>G.value=e),title:"分配按钮","destroy-on-close":""},{footer:r(()=>[n("div",B,[u(f,{onClick:K},{default:r(()=>t[4]||(t[4]=[d("取 消")])),_:1,__:[4]}),u(f,{type:"primary",onClick:L},{default:r(()=>t[5]||(t[5]=[d("确 定")])),_:1,__:[5]})])]),default:r(()=>[u(x,{ref_key:"btnTableRef",ref:X,data:M.value,"row-key":"ID",onSelectionChange:H},{default:r(()=>[u(I,{type:"selection",width:"55"}),u(I,{label:"按钮名称",prop:"name"}),u(I,{label:"按钮备注",prop:"desc"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-cc0d1bfa"]]);export{x as default};
